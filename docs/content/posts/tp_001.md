---
title: "Описание модели данных"
PublishDate: 2023-07-20
author: "aagorlan"
tags: ["Онтология", "Git"]
description: "Описание методики моделирования данных, их версионирование и хранение в репозитории git"
---

{{< toc >}}

## Интерфейс просмотра модели данных

**Особенности объекта управления, влияющие на проектные решения по функции**
Не выявлено

**Входящие данные**
Набор XML-схем в модели данных, размещённых в структуре каталогов контура локального репозитория git.

**Исходящие данные**
Дерево классов

**Исполнитель**
Архитектор данных

**Описание реализуемых задач**
Из ветки локального репозитория git, соответствующей выбранному контуру, считывается набор XML-схем данных, десериализуется и с учётом структуры каталога конвертируется в дерево классов.

На форме выделяются области:

- дерево классов;
- метаданные классов (свойства классов, связи, табличные части);
- настройка свойств, прав и связей для выбранной строчки метаданных;

В дереве обеспечивается отбор по группе или просмотр полного дерева классов. Реализуется просмотр классов, их свойств, табличных частей и связей.

При отображении свойств класса добавляются свойства наследуемых классов, наследуемые свойства формируются выделяются синим цветом.

На форме выводятся связи всех направлений (исходящие, входящие, полные), доступные для класса. Синим цветом выделяются обязательные связи. Обеспечивается просмотр детальных свойств связи.

При использовании контура, предполагающего изменение данных, интерфейс позволяет перейти к изменению свойств выбранного элемента. Исключение составляют наследуемые свойства, их изменение доступно только непосредственно из класса – владельца.

## Управление классами

**Особенности объекта управления, влияющие на проектные решения по функции**
Не выявлено

**Входящие данные**
Отсутствуют

**Исходящие данные**
Структура, описывающая класс; карта соответствия имён;

**Исполнитель**
Архитектор данных

**Описание реализуемых задач**
Разрабатывается пользовательский интерфейс для управления классами.

Интерфейс, помимо создания классов с уникальным именем и присвоенным уникальным идентификатором, обеспечивает:

- Возможность создания класса как дочернего;
- Проверку указанного имени класса на уникальность (в модели данных должны отсутствовать классы с таким же именем);
- Запись в карту соответствия имён транслитерированного имени класса;
- Выбор группы для класса из структуры групп классов или добавление новой группы с помещением её в структуру;
- Выбор информационных систем, имеющих доступ для чтения, добавления, изменения и удаления (предполагается, что при отсутствии описания доступа у свойств или связей права доступа будут наследоваться у класса).

В результате создания класса формируется структура, описывающая класс.

**Модель данных**
Структура класса:

- Имя папки;

Карта соответствия имён:

- Уникальный идентификатор;
- Имя;
- Транслит.

## Добавление свойств

**Особенности объекта управления, влияющие на проектные решения по функции**
Не выявлено

**Входящие данные**
Отсутствуют

**Исходящие данные**
Структура, описывающая свойства класса; структура типов свойств классов в карте имён;

**Исполнитель**
Архитектор данных

**Описание реализуемых задач**
Разрабатывается пользовательский интерфейс для добавления собственных свойств класса примитивного типа: строка, число, булево, дата. Выбор значений свойств происходит из структуры типов свойств классов.

Реализуется автоматическая проверка указанного имени свойства на уникальность (у класса должны отсутствовать свойства с таким же именем);

Для свойства обеспечивается возможность задания ограничивающих условий: длина строки, разрядность числа, перечень значений, диапазон значений, обязательность заполнения, возможность указания нескольких значений, а также отметка о том, что свойство является ключевым (не допускается ввод данных, совокупность значений ключевых свойств которых не уникальная).

Доступна настройка списка информационных систем, имеющих право на чтение и изменение свойств класса.

В результате создания свойства формируется структура, описывающая свойство класса.

**Модель данных**
Структура свойства класса:

- Имя свойства;
- Тип свойства;
- Ключевое;
- Длина;
- Разрядность;
- Минимум (необходимо по-разному обрабатывать «0» и пустое значение);
- Максимум (необходимо по-разному обрабатывать «0» и пустое значение);
- Не пустое;
- Множественное;
- Значения (массив).

Карта соответствия имён:

- Наименование;
- Пространство имен – Строка.

## Создание типов связей

**Особенности объекта управления, влияющие на проектные решения по функции**
Не выявлено

**Входящие данные**
Отсутствуют

**Исходящие данные**
Структура типов связей

**Исполнитель**
Архитектор данных

**Описание реализуемых задач**
Разрабатывается пользовательский интерфейс для заполнения структуры типов связей.

Обеспечивается проверку указанного имени типа связи на уникальность (в модели данных должны отсутствовать типы связи с таким же именем);

Производится запись в карту соответствия имён транслитерированного имени типа связи;

В результате создания типов связей формируется структура, которая сериализуется в XML и помещается в модель данных в структуре каталогов контура локального репозитория Git, в соответствующую контуру задачи ветку.

**Модель данных**
Структура типов связей:

- Имя типа связи;
- Уникальный идентификатор;

Карта соответствия имён:

- Имя;
- Транслит.

## Добавление связей

**Особенности объекта управления, влияющие на проектные решения по функции**
Не выявлено

**Входящие данные**
Структура типов связей

**Исходящие данные**
Структура доступных связей

**Исполнитель**
Архитектор данных

**Описание реализуемых задач**
Разрабатывается пользовательский интерфейс для добавления доступных для классов связей. Выбор значений свойств происходит из структуры типов связей.

Для связи указываются: тип, классы, между которыми она устанавливается, признак обязательности связи, и, если связь должна быть полной, тип связи, обратный текущей: при добавлении связи дублирующая в обратном направлении связь должна устанавливаться автоматически.

Доступен выбор информационных систем, имеющих доступ на добавление и удаление связи.

В результате создания связи формируется структура.

**Модель данных**
Структура доступных связей:

- Тип связи;
- Связь от (уникальный идентификатор класса);
- Связь к (уникальный идентификатор класса)
- Обязательная связь;
- Дополнять (Тип связи).

## Добавление табличной части

**Особенности объекта управления, влияющие на проектные решения по функции**
Не выявлено

**Входящие данные**
Список добавленных классов

**Исходящие данные**
Структура, описывающая табличную часть свойства класса

**Исполнитель**
Архитектор данных

**Описание реализуемых задач**
Разрабатывается пользовательский интерфейс для добавления массивов (табличной части) свойств класса. Состав свойств описывается свойствами связанного класса (необходима проверка на наличие связи).

Доступна настройка доступа информационных систем к табличной части в разрезе таблицы.

В результате создания формируется структура, описывающая табличную часть свойств класса.

**Модель данных**
Структура добавления табличной части класса:

- Имя табличной части;

## Удаление элементов

**Особенности объекта управления, влияющие на проектные решения по функции**
Не выявлено

**Входящие данные**
Структура, описывающая модель данных

**Исходящие данные**
Структура, описывающая модель данных

**Исполнитель**
Архитектор данных

**Описание реализуемых задач**
В пользовательском интерфейсе обеспечивается возможность выбрать элемент модели данных (класс, свойство, связь, табличную часть) для удаления. После подтверждения из модели данных исключается выбранный элемент. При удалении класса исключаются связанные с ним элементы: свойства, связи, табличные части.

**Модель данных**
Описание структуры модели данных не изменяется

## Управление доступом

**Особенности объекта управления, влияющие на проектные решения по функции**
Не выявлено

**Входящие данные**
Структура модели данных;

**Исходящие данные**
Структура доступа к элементам в модели данных (карта доступа)

**Исполнитель**
Архитектор данных

**Описание реализуемых задач**
Реализуется интерфейс, позволяющий установить доступ информационных систем к действиям с элементами модели:

|элемент/право|чтение|добавление|изменение|удаление|
| :- | :-: | :-: | :-: | :-: |
|класс|+|+|+|+|
|свойство|+||+||
|табличная часть|+||+||
*в таблице «+» означает применимость права к элементу*

Для записи права доступа на элемент используется структура с ключевыми полями, указывающими на: ИС, элемент (уникальный идентификатор класса, свойства или табличной части), тип права. В качестве флага доступа используется поле «Доступ». Право доступа к связям определяется суммированием прав доступа к обоим классам связи.

Действует следующая логика предоставления доступа:

1. Если элемент является свойством, обязательным к заполнению (Поле «Не пустое» установлено в «Истина»), то доступ к чтению свойства разрешается всем ИС.
2. Если по уникальным полям существует запись, то право доступа к данному элементу определяется полем «Доступ»: «Истина» - доступ разрешён, «Ложь» - запрещён;
3. Если по уникальным полям запись не найдена, производится поиск первой записи по уникальным полям для вышестоящих элементов: для свойств, связей и табличный частей – это класс или его родительские классы, для класса – родительские классы в восходящей иерархии. Найденная запись определяет порядок доступа.
4. Если в результате поиска весь алгоритм не вернул подходящую запись – доступ запрещается.

В результате работы функции формируется структура доступа (карта доступа).

**Модель данных**
Структура карты доступа:

- Код ИС (код информационного ресурса из справочника «Информационные ресурсы»);
- Уникальный идентификатор элемента;
- Тип права (строка «чтение», «добавление», «изменение», «удаление»);
- Доступ (булево).

## Транслитерация имён

**Особенности объекта управления, влияющие на проектные решения по функции**
Не выявлено

**Входящие данные**
Строковое кириллическое имя объекта; желаемое латинское имя (необязательно)

**Исходящие данные**
Транслитерированное имя объекта; карта соответствия имён; признак наличия в карте транслитерированной пары для указанного имени; текст ошибки;

**Исполнитель**
Архитектор данных

**Описание реализуемых задач**
Функция осуществляется автоматическую транслитерацию имени объекта в символы латинского алфавита для использования в качестве имени объекта в БД. Составляет пары «кириллица - транслит», каждое значение имени в которых является уникальным для всей карты соответствия имён. Если передано желаемое латинское имя – использует его.

В случае, если переданное значение кириллического имени уже присутствует в карте, возвращается ранее установленное значение транслитерированного имени, и признак наличия в карте транслитерированной пары для указанного имени устанавливается в значение «Истина» - это означает, что для такого имени «перевод» уже есть и используется в модели данных (как имя свойства, связи, табличной части, класса), поэтому в пользовательском интерфейсе в поле для транслитерированного имени устанавливается уже используемое значение, собственный вариант установить нельзя.

Если в ходе транслитерации произошли ошибки, например, из-за коллизии значений (одинаковый «перевод» двух разных имён, одно из которых уже содержится в карте), заполняется реквизит «Текст ошибки». Его можно отобразить пользователю вместе с предложением выбрать другое имя, или указать свой вариант транслитерации.

В результате работы функции формируется структура, описывающая карту соответствия имён.

**Модель данных**
Карта соответствия имён (структура):

- Имя;
- Транслит.

## Хранение модели

**Особенности объекта управления, влияющие на проектные решения по функции**
Не выявлено

**Входящие данные**
Структура, описывающая класс, его свойства, связи и табличные части; структура типов свойств классов; структура групп классов; структура типов связей; карта соответствия имён; карта доступа;

**Исходящие данные**
XML-схема (модель данных), размещённая в структуре каталогов контура локального репозитория git.

**Исполнитель**
Архитектор данных

**Описание реализуемых задач**
Для обеспечения удобства передачи модели данных и сериализации разрабатывается пакет XDTO, полностью описывающий модель.

В момент сохранения массив структур классов и вспомогательные структуры сериализуются в XDTO, включающий также свойства, связи и табличные части класса, а также структуру типов свойств классов, структуру групп классов, структуру типов связей, карту соответствия имён и карту доступа, объект записывается в ветку локального репозитория Git.

Для хранения используется следующая структура каталогов:

- Корневой каталог модели
  - Каталог - Имя группы классов (Распределение классов по группам для удобства навигации)
    - Каталог - Имя класса
      - Каталог - Имя подчиненного класса
        - Файл - scheme.xml (описание подчиненного класса, его свойств и табличных частей)
        - Файл - tables.xml (описание таблиц подчиненного класса)
        - Файл - rel.xml (описание связей подчиненного класса)
        - Файл - access.xml (описание прав доступа подчиненного класса и свойств)
      - Файл - scheme.xml (описание класса, его свойств и табличных частей)
      - Файл - tables.xml (описание таблиц класса)
      - Файл - rel.xml (описание связей класса)
      - Файл - access.xml (описание прав доступа класса и свойств)
  - Файл - names.xml (карта соответствия имён, содержащая весь перечень классов для проверки на уникальность)
  - Файл - rel.xml (карта типов связей, содержащая перечень классов, используемых для каждого типа)
